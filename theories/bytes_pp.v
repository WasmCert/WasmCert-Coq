Require Import Coq.Strings.String.
Open Scope string_scope.
Require Import Byte.

(* for pretty-printing *)
Definition hex_small_no_prefix_of_byte (b : byte) :=
(*
#!/usr/bin/env ocaml
open Char
let a_code = Char.code 'a'
let show = function
| x when x < 10 -> string_of_int x
| x -> String.make 1 (Char.chr (a_code + x - 10))
let _ =
for i = 0 to 15 do
for j = 0 to 15 do
let x = show i in
let y = show j in
print_string ("| x" ^ x ^ y ^ " => \"" ^ x ^ y ^ "\"\n")
done
done
*)
match b with
| x00 => "00"
| x01 => "01"
| x02 => "02"
| x03 => "03"
| x04 => "04"
| x05 => "05"
| x06 => "06"
| x07 => "07"
| x08 => "08"
| x09 => "09"
| x0a => "0a"
| x0b => "0b"
| x0c => "0c"
| x0d => "0d"
| x0e => "0e"
| x0f => "0f"
| x10 => "10"
| x11 => "11"
| x12 => "12"
| x13 => "13"
| x14 => "14"
| x15 => "15"
| x16 => "16"
| x17 => "17"
| x18 => "18"
| x19 => "19"
| x1a => "1a"
| x1b => "1b"
| x1c => "1c"
| x1d => "1d"
| x1e => "1e"
| x1f => "1f"
| x20 => "20"
| x21 => "21"
| x22 => "22"
| x23 => "23"
| x24 => "24"
| x25 => "25"
| x26 => "26"
| x27 => "27"
| x28 => "28"
| x29 => "29"
| x2a => "2a"
| x2b => "2b"
| x2c => "2c"
| x2d => "2d"
| x2e => "2e"
| x2f => "2f"
| x30 => "30"
| x31 => "31"
| x32 => "32"
| x33 => "33"
| x34 => "34"
| x35 => "35"
| x36 => "36"
| x37 => "37"
| x38 => "38"
| x39 => "39"
| x3a => "3a"
| x3b => "3b"
| x3c => "3c"
| x3d => "3d"
| x3e => "3e"
| x3f => "3f"
| x40 => "40"
| x41 => "41"
| x42 => "42"
| x43 => "43"
| x44 => "44"
| x45 => "45"
| x46 => "46"
| x47 => "47"
| x48 => "48"
| x49 => "49"
| x4a => "4a"
| x4b => "4b"
| x4c => "4c"
| x4d => "4d"
| x4e => "4e"
| x4f => "4f"
| x50 => "50"
| x51 => "51"
| x52 => "52"
| x53 => "53"
| x54 => "54"
| x55 => "55"
| x56 => "56"
| x57 => "57"
| x58 => "58"
| x59 => "59"
| x5a => "5a"
| x5b => "5b"
| x5c => "5c"
| x5d => "5d"
| x5e => "5e"
| x5f => "5f"
| x60 => "60"
| x61 => "61"
| x62 => "62"
| x63 => "63"
| x64 => "64"
| x65 => "65"
| x66 => "66"
| x67 => "67"
| x68 => "68"
| x69 => "69"
| x6a => "6a"
| x6b => "6b"
| x6c => "6c"
| x6d => "6d"
| x6e => "6e"
| x6f => "6f"
| x70 => "70"
| x71 => "71"
| x72 => "72"
| x73 => "73"
| x74 => "74"
| x75 => "75"
| x76 => "76"
| x77 => "77"
| x78 => "78"
| x79 => "79"
| x7a => "7a"
| x7b => "7b"
| x7c => "7c"
| x7d => "7d"
| x7e => "7e"
| x7f => "7f"
| x80 => "80"
| x81 => "81"
| x82 => "82"
| x83 => "83"
| x84 => "84"
| x85 => "85"
| x86 => "86"
| x87 => "87"
| x88 => "88"
| x89 => "89"
| x8a => "8a"
| x8b => "8b"
| x8c => "8c"
| x8d => "8d"
| x8e => "8e"
| x8f => "8f"
| x90 => "90"
| x91 => "91"
| x92 => "92"
| x93 => "93"
| x94 => "94"
| x95 => "95"
| x96 => "96"
| x97 => "97"
| x98 => "98"
| x99 => "99"
| x9a => "9a"
| x9b => "9b"
| x9c => "9c"
| x9d => "9d"
| x9e => "9e"
| x9f => "9f"
| xa0 => "a0"
| xa1 => "a1"
| xa2 => "a2"
| xa3 => "a3"
| xa4 => "a4"
| xa5 => "a5"
| xa6 => "a6"
| xa7 => "a7"
| xa8 => "a8"
| xa9 => "a9"
| xaa => "aa"
| xab => "ab"
| xac => "ac"
| xad => "ad"
| xae => "ae"
| xaf => "af"
| xb0 => "b0"
| xb1 => "b1"
| xb2 => "b2"
| xb3 => "b3"
| xb4 => "b4"
| xb5 => "b5"
| xb6 => "b6"
| xb7 => "b7"
| xb8 => "b8"
| xb9 => "b9"
| xba => "ba"
| xbb => "bb"
| xbc => "bc"
| xbd => "bd"
| xbe => "be"
| xbf => "bf"
| xc0 => "c0"
| xc1 => "c1"
| xc2 => "c2"
| xc3 => "c3"
| xc4 => "c4"
| xc5 => "c5"
| xc6 => "c6"
| xc7 => "c7"
| xc8 => "c8"
| xc9 => "c9"
| xca => "ca"
| xcb => "cb"
| xcc => "cc"
| xcd => "cd"
| xce => "ce"
| xcf => "cf"
| xd0 => "d0"
| xd1 => "d1"
| xd2 => "d2"
| xd3 => "d3"
| xd4 => "d4"
| xd5 => "d5"
| xd6 => "d6"
| xd7 => "d7"
| xd8 => "d8"
| xd9 => "d9"
| xda => "da"
| xdb => "db"
| xdc => "dc"
| xdd => "dd"
| xde => "de"
| xdf => "df"
| xe0 => "e0"
| xe1 => "e1"
| xe2 => "e2"
| xe3 => "e3"
| xe4 => "e4"
| xe5 => "e5"
| xe6 => "e6"
| xe7 => "e7"
| xe8 => "e8"
| xe9 => "e9"
| xea => "ea"
| xeb => "eb"
| xec => "ec"
| xed => "ed"
| xee => "ee"
| xef => "ef"
| xf0 => "f0"
| xf1 => "f1"
| xf2 => "f2"
| xf3 => "f3"
| xf4 => "f4"
| xf5 => "f5"
| xf6 => "f6"
| xf7 => "f7"
| xf8 => "f8"
| xf9 => "f9"
| xfa => "fa"
| xfb => "fb"
| xfc => "fc"
| xfd => "fd"
| xfe => "fe"
| xff => "ff"
end.

Definition hex_small_to_bin (b : byte) :=
match b with
| x00 => "00000000"
| x01 => "00000001"
| x02 => "00000010"
| x03 => "00000011"
| x04 => "00000100"
| x05 => "00000101"
| x06 => "00000110"
| x07 => "00000111"
| x08 => "00001000"
| x09 => "00001001"
| x0a => "00001010"
| x0b => "00001011"
| x0c => "00001100"
| x0d => "00001101"
| x0e => "00001110"
| x0f => "00001111"
| x10 => "00010000"
| x11 => "00010001"
| x12 => "00010010"
| x13 => "00010011"
| x14 => "00010100"
| x15 => "00010101"
| x16 => "00010110"
| x17 => "00010111"
| x18 => "00011000"
| x19 => "00011001"
| x1a => "00011010"
| x1b => "00011011"
| x1c => "00011100"
| x1d => "00011101"
| x1e => "00011110"
| x1f => "00011111"
| x20 => "00100000"
| x21 => "00100001"
| x22 => "00100010"
| x23 => "00100011"
| x24 => "00100100"
| x25 => "00100101"
| x26 => "00100110"
| x27 => "00100111"
| x28 => "00101000"
| x29 => "00101001"
| x2a => "00101010"
| x2b => "00101011"
| x2c => "00101100"
| x2d => "00101101"
| x2e => "00101110"
| x2f => "00101111"
| x30 => "00110000"
| x31 => "00110001"
| x32 => "00110010"
| x33 => "00110011"
| x34 => "00110100"
| x35 => "00110101"
| x36 => "00110110"
| x37 => "00110111"
| x38 => "00111000"
| x39 => "00111001"
| x3a => "00111010"
| x3b => "00111011"
| x3c => "00111100"
| x3d => "00111101"
| x3e => "00111110"
| x3f => "00111111"
| x40 => "01000000"
| x41 => "01000001"
| x42 => "01000010"
| x43 => "01000011"
| x44 => "01000100"
| x45 => "01000101"
| x46 => "01000110"
| x47 => "01000111"
| x48 => "01001000"
| x49 => "01001001"
| x4a => "01001010"
| x4b => "01001011"
| x4c => "01001100"
| x4d => "01001101"
| x4e => "01001110"
| x4f => "01001111"
| x50 => "01010000"
| x51 => "01010001"
| x52 => "01010010"
| x53 => "01010011"
| x54 => "01010100"
| x55 => "01010101"
| x56 => "01010110"
| x57 => "01010111"
| x58 => "01011000"
| x59 => "01011001"
| x5a => "01011010"
| x5b => "01011011"
| x5c => "01011100"
| x5d => "01011101"
| x5e => "01011110"
| x5f => "01011111"
| x60 => "01100000"
| x61 => "01100001"
| x62 => "01100010"
| x63 => "01100011"
| x64 => "01100100"
| x65 => "01100101"
| x66 => "01100110"
| x67 => "01100111"
| x68 => "01101000"
| x69 => "01101001"
| x6a => "01101010"
| x6b => "01101011"
| x6c => "01101100"
| x6d => "01101101"
| x6e => "01101110"
| x6f => "01101111"
| x70 => "01110000"
| x71 => "01110001"
| x72 => "01110010"
| x73 => "01110011"
| x74 => "01110100"
| x75 => "01110101"
| x76 => "01110110"
| x77 => "01110111"
| x78 => "01111000"
| x79 => "01111001"
| x7a => "01111010"
| x7b => "01111011"
| x7c => "01111100"
| x7d => "01111101"
| x7e => "01111110"
| x7f => "01111111"
| x80 => "10000000"
| x81 => "10000001"
| x82 => "10000010"
| x83 => "10000011"
| x84 => "10000100"
| x85 => "10000101"
| x86 => "10000110"
| x87 => "10000111"
| x88 => "10001000"
| x89 => "10001001"
| x8a => "10001010"
| x8b => "10001011"
| x8c => "10001100"
| x8d => "10001101"
| x8e => "10001110"
| x8f => "10001111"
| x90 => "10010000"
| x91 => "10010001"
| x92 => "10010010"
| x93 => "10010011"
| x94 => "10010100"
| x95 => "10010101"
| x96 => "10010110"
| x97 => "10010111"
| x98 => "10011000"
| x99 => "10011001"
| x9a => "10011010"
| x9b => "10011011"
| x9c => "10011100"
| x9d => "10011101"
| x9e => "10011110"
| x9f => "10011111"
| xa0 => "10100000"
| xa1 => "10100001"
| xa2 => "10100010"
| xa3 => "10100011"
| xa4 => "10100100"
| xa5 => "10100101"
| xa6 => "10100110"
| xa7 => "10100111"
| xa8 => "10101000"
| xa9 => "10101001"
| xaa => "10101010"
| xab => "10101011"
| xac => "10101100"
| xad => "10101101"
| xae => "10101110"
| xaf => "10101111"
| xb0 => "10110000"
| xb1 => "10110001"
| xb2 => "10110010"
| xb3 => "10110011"
| xb4 => "10110100"
| xb5 => "10110101"
| xb6 => "10110110"
| xb7 => "10110111"
| xb8 => "10111000"
| xb9 => "10111001"
| xba => "10111010"
| xbb => "10111011"
| xbc => "10111100"
| xbd => "10111101"
| xbe => "10111110"
| xbf => "10111111"
| xc0 => "11000000"
| xc1 => "11000001"
| xc2 => "11000010"
| xc3 => "11000011"
| xc4 => "11000100"
| xc5 => "11000101"
| xc6 => "11000110"
| xc7 => "11000111"
| xc8 => "11001000"
| xc9 => "11001001"
| xca => "11001010"
| xcb => "11001011"
| xcc => "11001100"
| xcd => "11001101"
| xce => "11001110"
| xcf => "11001111"
| xd0 => "11010000"
| xd1 => "11010001"
| xd2 => "11010010"
| xd3 => "11010011"
| xd4 => "11010100"
| xd5 => "11010101"
| xd6 => "11010110"
| xd7 => "11010111"
| xd8 => "11011000"
| xd9 => "11011001"
| xda => "11011010"
| xdb => "11011011"
| xdc => "11011100"
| xdd => "11011101"
| xde => "11011110"
| xdf => "11011111"
| xe0 => "11100000"
| xe1 => "11100001"
| xe2 => "11100010"
| xe3 => "11100011"
| xe4 => "11100100"
| xe5 => "11100101"
| xe6 => "11100110"
| xe7 => "11100111"
| xe8 => "11101000"
| xe9 => "11101001"
| xea => "11101010"
| xeb => "11101011"
| xec => "11101100"
| xed => "11101101"
| xee => "11101110"
| xef => "11101111"
| xf0 => "11110000"
| xf1 => "11110001"
| xf2 => "11110010"
| xf3 => "11110011"
| xf4 => "11110100"
| xf5 => "11110101"
| xf6 => "11110110"
| xf7 => "11110111"
| xf8 => "11111000"
| xf9 => "11111001"
| xfa => "11111010"
| xfb => "11111011"
| xfc => "11111100"
| xfd => "11111101"
| xfe => "11111110"
| xff => "11111111"
end.

Definition hex_small_no_prefix_of_bytes (x : list Byte.byte) :=
  String.concat " " (List.map hex_small_no_prefix_of_byte x).

Definition hex_small_no_prefix_of_bytes_compact (x : list Byte.byte) :=
  String.concat "" (List.map hex_small_no_prefix_of_byte x).

Definition hex_small_no_prefix_of_bytes_compact_bin (x : list Byte.byte) :=
  String.concat "" (List.map hex_small_to_bin x).
